const _0x13807c=_0x157d;(function(_0x2a8743,_0xddcf02){const _0x185948=_0x157d,_0x387045=_0x2a8743();while(!![]){try{const _0x347437=-parseInt(_0x185948(0x225))/0x1*(-parseInt(_0x185948(0x1e7))/0x2)+-parseInt(_0x185948(0x208))/0x3*(parseInt(_0x185948(0x1a5))/0x4)+parseInt(_0x185948(0x1ac))/0x5+-parseInt(_0x185948(0x1da))/0x6+-parseInt(_0x185948(0x239))/0x7*(-parseInt(_0x185948(0x1ad))/0x8)+parseInt(_0x185948(0x23a))/0x9+-parseInt(_0x185948(0x1cb))/0xa*(parseInt(_0x185948(0x1bf))/0xb);if(_0x347437===_0xddcf02)break;else _0x387045['push'](_0x387045['shift']());}catch(_0x5698ac){_0x387045['push'](_0x387045['shift']());}}}(_0x722d,0xb82cd));const {Server,ServerEvent}=require(_0x13807c(0x1a0)),WebSocket=require('ws'),fetch=require(_0x13807c(0x19d)),wanakana=require(_0x13807c(0x1f2)),fs=require('fs'),JSON5=require(_0x13807c(0x1ee)),getPort=require(_0x13807c(0x226)),{Client}=require(_0x13807c(0x22a)),net=require(_0x13807c(0x207)),express=require('express'),http=require(_0x13807c(0x20c)),path=require(_0x13807c(0x1c5)),{server}=require(_0x13807c(0x1ab)),configPath=_0x13807c(0x19c),config=JSON5[_0x13807c(0x1ed)](fs[_0x13807c(0x22e)](configPath,'utf8'));let {app_id='',secret_key='',username='',sub_domain='',sub_domain2='',ssh_password='',port=0x4abc,web_port=0x1f40,proximity=!![],spectator=!![],specListen=!![],specDim=![],password=![],distance=0x6,lang='en'}=config,roomId=sub_domain,stop_roop=![],passwords={},positions={},yRots={},dimensions={},shouldBroadcast=!![],vc_connected=![],mc_connected=![],wss,relayWs,mainWorld,vcSSHClient,mcSSHClient,spectators={},useRelay=![],streamlit=![],useResetTimer=![];const server_log_info=_0x3ffb59=>console['log'](_0x13807c(0x23e)+_0x3ffb59),server_log_log=_0x2ac2c0=>console[_0x13807c(0x184)]('\x1b[33m[Log]\x1b[0m\x20'+_0x2ac2c0),processName=_0x78389d=>wanakana[_0x13807c(0x224)](_0x78389d['replace'](/ /g,'_'))['replace'](/n'/g,'n'),RELAY_SERVER_DOMAIN='mcproxvc.tcpexposer.com',INACTIVITY_TIMEOUT=0x5*0x3c*0x3e8;let inactivityTimer;const resetTimer=()=>{clearTimeout(inactivityTimer),inactivityTimer=setTimeout(()=>{const _0x120d49=_0x157d;process[_0x120d49(0x236)](0x7c);},INACTIVITY_TIMEOUT);},filePath=path['join'](__dirname,_0x13807c(0x18a));fs['existsSync'](filePath)&&(streamlit=!![],resetTimer(),useResetTimer=!![]);function startSshForwarding(_0x2ba096,_0x2e36a0,_0x308de5){const _0x4e3fd7=_0x13807c;if(!_0x2ba096||!username||!ssh_password)return;const _0x41de78=_0x308de5==='vc',_0x1b2d15=_0x41de78?'[VC\x20SSH]':_0x4e3fd7(0x1b7),_0x26a45d={'host':_0x4e3fd7(0x1b1),'port':0x16,'username':username,'password':ssh_password},_0x2c4084={'remoteAddr':_0x2ba096,'remotePort':0x50,'localAddr':'localhost','localPort':_0x2e36a0},_0x1dfcbc=new Client();return _0x1dfcbc['on'](_0x4e3fd7(0x1f9),()=>{const _0x248854=_0x4e3fd7;_0x1dfcbc['forwardIn'](_0x2c4084[_0x248854(0x1a1)],_0x2c4084[_0x248854(0x218)],_0x348197=>{const _0x205629=_0x248854;if(_0x348197)return console[_0x205629(0x195)](_0x1b2d15+_0x205629(0x235)+_0x2ba096+'):',_0x348197[_0x205629(0x18b)]),server_log_info(_0x1b2d15+'中継サーバーを使用します\x20(Relay\x20server\x20will\x20be\x20used)'),connectToRelayServer(_0x308de5),_0x1dfcbc[_0x205629(0x20a)]();console['log'](_0x205629(0x1ca));if(_0x41de78){useRelay=![],vc_connected=!![],server_log_info('ROOM\x20ID:\x20'+_0x2ba096);if(lang==='en')server_log_info(_0x205629(0x21c));else server_log_info(_0x205629(0x1df));server_log_info(_0x205629(0x1d4)+_0x2ba096);}else{if(lang==='en')server_log_info('Connect\x20from\x20Minecraft\x20with\x20the\x20following\x20command:');else server_log_info(_0x205629(0x20d));server_log_info(_0x205629(0x216)+_0x2ba096+_0x205629(0x18e));if(lang==='en')server_log_info(_0x205629(0x206));else server_log_info(_0x205629(0x197));server_log_info(_0x205629(0x1db)+_0x2ba096+_0x205629(0x1a2));}console[_0x205629(0x184)](_0x205629(0x1f8));}),_0x1dfcbc['on'](_0x248854(0x23f),(_0x368e07,_0x2010c4)=>{const _0x1a1dd5=_0x248854,_0x351671=_0x2010c4(),_0x29a824=net[_0x1a1dd5(0x1e4)]({'host':_0x2c4084['localAddr'],'port':_0x2c4084[_0x1a1dd5(0x1fb)]});_0x29a824['on'](_0x1a1dd5(0x1d9),()=>_0x351671[_0x1a1dd5(0x20e)](_0x29a824)['pipe'](_0x351671)),_0x29a824['on'](_0x1a1dd5(0x195),_0x5b52d7=>{const _0x3d3cc7=_0x1a1dd5;console[_0x3d3cc7(0x195)]('ローカル接続エラー\x20('+_0x2ba096+'):',_0x5b52d7[_0x3d3cc7(0x18b)]),_0x351671[_0x3d3cc7(0x205)]();}),_0x351671['on'](_0x1a1dd5(0x205),()=>_0x29a824[_0x1a1dd5(0x20a)]());});})['on'](_0x4e3fd7(0x195),_0x209872=>{const _0x4b7b44=_0x4e3fd7;console[_0x4b7b44(0x195)](_0x4b7b44(0x1e6)+_0x2ba096+'):',_0x209872['message']),server_log_info(_0x1b2d15+_0x4b7b44(0x1f3)),connectToRelayServer(_0x308de5);}),_0x1dfcbc[_0x4e3fd7(0x1d9)](_0x26a45d),_0x1dfcbc;}async function setupWebSocketServer(){const _0x211b73=_0x13807c;if(sub_domain===''||username===''||ssh_password==='')return;wss=new WebSocket[(_0x211b73(0x1c4))]({'port':web_port}),wss['on']('connection',_0x13e017=>{const _0x3309fd=_0x211b73;_0x13e017['on'](_0x3309fd(0x18b),_0x40a0db=>{const _0x592694=_0x3309fd;try{const {userName:_0x511de2,position:_0x7a8206}=JSON['parse'](_0x40a0db);if(_0x511de2&&_0x7a8206)positions[_0x511de2]=_0x7a8206;}catch(_0x1328eb){console[_0x592694(0x195)](_0x592694(0x1d1),_0x1328eb);}}),_0x13e017['on'](_0x3309fd(0x195),_0x3f246a=>console[_0x3309fd(0x195)](_0x3309fd(0x1d7),_0x3f246a));}),vcSSHClient=startSshForwarding(sub_domain,web_port,'vc');if(sub_domain2)mcSSHClient=startSshForwarding(sub_domain2,port,'mc');else console[_0x211b73(0x184)](_0x211b73(0x1ca)),server_log_info(_0x211b73(0x20d)),server_log_info(_0x211b73(0x1dc)),server_log_info('/connect\x20localhost:'+port),console['log']('=======================================================\x0a');process['on'](_0x211b73(0x22d),()=>{const _0x46d7ab=_0x211b73;console[_0x46d7ab(0x184)](_0x46d7ab(0x1ec));if(vcSSHClient)vcSSHClient[_0x46d7ab(0x20a)]();if(mcSSHClient)mcSSHClient[_0x46d7ab(0x20a)]();process[_0x46d7ab(0x236)]();});}function broadcastPositions(){const _0x181a44=_0x13807c,_0x2b540f=JSON[_0x181a44(0x1e3)]({'type':_0x181a44(0x230),'dimentions':dimensions,'proximity':proximity,'positions':positions,'distance':distance,'spectator':spectator,'spectators':spectators,'specListen':specListen,'specDim':specDim,'yRots':yRots,'dimensions':dimensions,'password':password,'passwords':passwords,'app_id':app_id,'secret_key':secret_key});if((sub_domain===''||username===''||ssh_password===''||useRelay)&&relayWs?.['readyState']===WebSocket['OPEN'])relayWs['send'](_0x2b540f);else sub_domain&&username&&ssh_password&&!useRelay&&wss[_0x181a44(0x19b)][_0x181a44(0x1e9)](_0x4d4a20=>{const _0x2b712d=_0x181a44;_0x4d4a20[_0x2b712d(0x22b)]===WebSocket[_0x2b712d(0x1c8)]&&_0x4d4a20[_0x2b712d(0x1c1)](_0x2b540f);});}async function handleWorld(_0x4f6e92){const _0x542814=_0x13807c;try{const _0x6a665c=Array[_0x542814(0x1bc)](_0x4f6e92[_0x542814(0x1ba)][_0x542814(0x217)](),_0x2fc6c7=>String(_0x2fc6c7[_0x542814(0x204)]));let _0x549ef4={'alive':[],'spectators':[],'details':[]};if(proximity){const [_0x5c1586,_0x270c97,_0x3e7d58]=await Promise[_0x542814(0x1ea)]([_0x4f6e92[_0x542814(0x222)](_0x542814(0x1c2)),_0x4f6e92['runCommand'](_0x542814(0x1c3)),_0x4f6e92['runCommand'](_0x542814(0x233))]);_0x549ef4={'alive':_0x5c1586[_0x542814(0x23b)]||[],'spectators':_0x270c97[_0x542814(0x23b)]||[],'details':JSON[_0x542814(0x1ed)](_0x3e7d58[_0x542814(0x188)]||'[]')};}_0x6a665c[_0x542814(0x1e9)](_0x4f0e62=>{const _0x245820=_0x542814;if(useResetTimer)resetTimer();let _0x37b289;if(proximity)_0x37b289=_0x549ef4[_0x245820(0x1ff)][_0x245820(0x213)](_0x4f0e62);const _0xf1aeff=processName(_0x4f0e62);_0x549ef4[_0x245820(0x1e1)]['includes'](_0x4f0e62)?spectators[_0xf1aeff]=!![]:spectators[_0xf1aeff]=![];if(!proximity)positions[_0xf1aeff]={'x':0x0,'y':0x2710,'z':0x0};else{if(!_0x549ef4[_0x245820(0x1ff)][_0x245820(0x1b8)](_0x4f0e62))positions[_0xf1aeff]={'x':0x0,'y':0x4e20,'z':0x0};else{if(spectator&&_0x549ef4[_0x245820(0x1e1)][_0x245820(0x1b8)](_0x4f0e62)){if(specListen===!![])positions[_0xf1aeff]=_0x549ef4[_0x245820(0x188)][_0x37b289][_0x245820(0x1dd)];else positions[_0xf1aeff]={'x':0x0,'y':0x2710,'z':0x0};if(specDim===!![])dimensions[_0xf1aeff]=_0x549ef4[_0x245820(0x188)][_0x37b289]['dimension'];}else _0x549ef4[_0x245820(0x188)][_0x37b289]?.[_0x245820(0x1dd)]?(positions[_0xf1aeff]=_0x549ef4['details'][_0x37b289][_0x245820(0x1dd)],yRots[_0xf1aeff]=_0x549ef4[_0x245820(0x188)][_0x37b289]['yRot'],dimensions[_0xf1aeff]=_0x549ef4[_0x245820(0x188)][_0x37b289][_0x245820(0x1f5)]):positions[_0xf1aeff]={'x':0x0,'y':0x7530,'z':0x0};}}}),shouldBroadcast=!![];}catch(_0x3139fb){console[_0x542814(0x195)](_0x542814(0x1c9),_0x3139fb);}if(!stop_roop)setTimeout(()=>handleWorld(_0x4f6e92),0x64);}function _0x157d(_0x465ead,_0x315635){const _0x722dfe=_0x722d();return _0x157d=function(_0x157d4d,_0x7bfed7){_0x157d4d=_0x157d4d-0x183;let _0x1eb300=_0x722dfe[_0x157d4d];return _0x1eb300;},_0x157d(_0x465ead,_0x315635);}async function connectToRelayServer(_0x3fbc6c){const _0x282677=_0x13807c,_0x1e484a=_0x3fbc6c==='mc',_0x17705d=_0x1e484a?_0x282677(0x200):'[VC\x20Relay]';try{const _0x236dda=await fetch(_0x282677(0x1f6)+RELAY_SERVER_DOMAIN+'/create-room'),_0x1692cc=await _0x236dda[_0x282677(0x1bd)](),_0x146465=_0x1692cc[_0x282677(0x1e8)];if(!_0x1e484a)roomId=_0x146465;console[_0x282677(0x184)](_0x282677(0x1ca));if(_0x1e484a){resetTimer(),useResetTimer=!![];if(lang==='en')server_log_info('Connect\x20from\x20Minecraft\x20with\x20the\x20following\x20command:');else server_log_info('Minecraftから以下のコマンドで接続してください:');server_log_info('/connect\x20'+RELAY_SERVER_DOMAIN+_0x282677(0x19f)+_0x146465);}else{useRelay=!![],vc_connected=!![],server_log_info(_0x282677(0x234)+_0x146465);if(lang==='en')server_log_info(_0x282677(0x21c));else server_log_info('参加者はこのURLにアクセスしてください:');server_log_info(_0x282677(0x1d4)+_0x146465);}console[_0x282677(0x184)](_0x282677(0x1f8));const _0x193ee3=new WebSocket(_0x282677(0x240)+RELAY_SERVER_DOMAIN+_0x282677(0x19f)+_0x146465+'?clientType=server_script');if(!_0x1e484a)relayWs=_0x193ee3;_0x193ee3['on'](_0x282677(0x185),()=>console[_0x282677(0x184)](_0x17705d+'\x20Relay\x20server\x20connected\x20(ID:\x20'+_0x146465+')')),_0x193ee3['on']('close',()=>console[_0x282677(0x184)](_0x17705d+_0x282677(0x1fa)+_0x146465+')')),_0x193ee3['on'](_0x282677(0x195),_0x3581a3=>console['error'](_0x17705d+_0x282677(0x221),_0x3581a3)),_0x1e484a?setupMcRelayListeners(_0x193ee3):setupVcRelayListeners(_0x193ee3);}catch(_0x433c40){console['error'](_0x17705d+_0x282677(0x237),_0x433c40);}}function setupVcRelayListeners(_0x37ddfd){const _0x5044e9=_0x13807c;_0x37ddfd['on'](_0x5044e9(0x18b),async _0x409625=>{const _0x48c5c5=_0x5044e9;try{const _0x5cca08=JSON['parse'](_0x409625[_0x48c5c5(0x187)]());if(mainWorld&&_0x5cca08[_0x48c5c5(0x1f0)]===_0x48c5c5(0x22c)&&typeof _0x5cca08['value']===_0x48c5c5(0x1f4)){const _0x515ddf=await mainWorld['runCommand'](_0x5cca08[_0x48c5c5(0x220)]);_0x37ddfd[_0x48c5c5(0x1c1)](JSON[_0x48c5c5(0x1e3)]({'type':_0x48c5c5(0x223),'payload':_0x515ddf}));}}catch(_0x53123b){console[_0x48c5c5(0x195)](_0x48c5c5(0x238),_0x53123b);}});}function name_command(_0xd743e8){const _0x108dfc=_0x13807c,_0x5b98c2=processName(_0xd743e8);!passwords[_0x5b98c2]&&(passwords[_0x5b98c2]=Math[_0x108dfc(0x211)](0x3e8+Math[_0x108dfc(0x1b2)]()*0x2328)[_0x108dfc(0x187)]());const _0x539ac4=lang==='ja'?_0x108dfc(0x1cf)+passwords[_0x5b98c2]+'です':_0x108dfc(0x227)+passwords[_0x5b98c2];return _0x539ac4;}function data_update(_0x4d24b2){const _0x1ed739=_0x13807c;shouldBroadcast=!![];if(useResetTimer)resetTimer();for(const [_0x4b33ad,_0x240d72]of Object['entries'](_0x4d24b2)){switch(_0x4b33ad){case _0x1ed739(0x1b5):continue;case _0x1ed739(0x1b6):_0x240d72!==proximity&&(updateConfig(_0x4b33ad,_0x240d72),proximity=_0x240d72);break;case'positions':positions=_0x240d72;break;case _0x1ed739(0x1a7):_0x240d72!==distance&&(updateConfig(_0x4b33ad,_0x240d72),distance=_0x240d72);break;case _0x1ed739(0x194):_0x240d72!==spectator&&(updateConfig(_0x4b33ad,_0x240d72),spectator=_0x240d72);break;case'spectators':spectators=_0x240d72;break;case _0x1ed739(0x1ce):_0x240d72!==specListen&&(updateConfig(_0x4b33ad,_0x240d72),specListen=_0x240d72);break;case _0x1ed739(0x19a):_0x240d72!==specDim&&(updateConfig(_0x4b33ad,_0x240d72),specDim=_0x240d72);break;case _0x1ed739(0x1d6):dimensions=_0x240d72;break;case _0x1ed739(0x214):yRots=_0x240d72;break;case _0x1ed739(0x1d0):_0x240d72!==password&&(updateConfig(_0x4b33ad,_0x240d72),password=_0x240d72);case _0x1ed739(0x1ef):_0x240d72!==lang&&(updateConfig(_0x4b33ad,_0x240d72),lang=_0x240d72);break;}}}function setupMcRelayListeners(_0x4b05c0){let _0x40c74a;_0x4b05c0['on']('message',async _0x3a9cf3=>{const _0x3f9204=_0x157d;try{const _0x33a32f=JSON['parse'](_0x3a9cf3[_0x3f9204(0x187)]());if(_0x33a32f[_0x3f9204(0x1b5)]===_0x3f9204(0x203)){console[_0x3f9204(0x184)](_0x3f9204(0x210)),_0x40c74a=new WebSocket(_0x3f9204(0x193)+port),_0x40c74a['on'](_0x3f9204(0x185),()=>console[_0x3f9204(0x184)]('[MC\x20Relay]\x20ローカルのsocket-beに接続成功。')),_0x40c74a['on'](_0x3f9204(0x18b),_0x1ff73f=>_0x4b05c0[_0x3f9204(0x22b)]===WebSocket[_0x3f9204(0x1c8)]&&_0x4b05c0[_0x3f9204(0x1c1)](_0x1ff73f)),_0x40c74a['on'](_0x3f9204(0x205),()=>_0x4b05c0[_0x3f9204(0x22b)]===WebSocket[_0x3f9204(0x1c8)]&&_0x4b05c0[_0x3f9204(0x205)]()),_0x40c74a['on']('error',_0x2828d3=>console[_0x3f9204(0x195)](_0x3f9204(0x18c),_0x2828d3[_0x3f9204(0x18b)]));return;}else{if(_0x33a32f[_0x3f9204(0x1b5)]===_0x3f9204(0x1c6))try{const _0x55334d=name_command(_0x33a32f[_0x3f9204(0x215)]),_0x2ac53e={'type':_0x3f9204(0x1c6),'message':_0x55334d,'correlationId':_0x33a32f[_0x3f9204(0x1af)]};_0x4b05c0[_0x3f9204(0x1c1)](JSON[_0x3f9204(0x1e3)](_0x2ac53e));}catch(_0x30e294){console['log'](_0x30e294);}else{if(_0x33a32f[_0x3f9204(0x1b5)]===_0x3f9204(0x1bb))try{mc_connected=!![];const _0x2fba1a=JSON[_0x3f9204(0x1e3)]({'type':'initialization','roomId':roomId,'proximity':proximity,'distance':distance,'spectator':spectator,'specListen':specListen,'specDim':specDim,'password':password,'lang':lang,'correlationId':_0x33a32f[_0x3f9204(0x1af)]});_0x4b05c0[_0x3f9204(0x1c1)](_0x2fba1a);}catch(_0x1f3817){console[_0x3f9204(0x184)](_0x1f3817);}else{if(_0x33a32f[_0x3f9204(0x1b5)]===_0x3f9204(0x190))try{data_update(_0x33a32f);}catch(_0x5e8b89){console[_0x3f9204(0x184)](_0x5e8b89);}else _0x33a32f[_0x3f9204(0x1b5)]===_0x3f9204(0x1b9)&&process[_0x3f9204(0x236)](0x0);}}}}catch(_0x16f14c){}_0x40c74a?.['readyState']===WebSocket[_0x3f9204(0x1c8)]&&_0x40c74a[_0x3f9204(0x1c1)](_0x3a9cf3);}),_0x4b05c0['on']('close',()=>_0x40c74a?.['close']());}function updateConfig(_0x4cf60a,_0xbfd04f){const _0x2d5a13=_0x13807c;try{let _0x25236e=fs[_0x2d5a13(0x22e)](configPath,_0x2d5a13(0x1e5));const _0x5f15c3=new RegExp('(\x22'+_0x4cf60a+_0x2d5a13(0x1cc)),_0x27d434=typeof _0xbfd04f===_0x2d5a13(0x1f4)?'\x22'+_0xbfd04f+'\x22':_0xbfd04f,_0x3e6735=_0x25236e['replace'](_0x5f15c3,'$1'+_0x27d434);_0x3e6735!==_0x25236e&&fs[_0x2d5a13(0x1a8)](configPath,_0x3e6735,_0x2d5a13(0x1e5));}catch(_0x22d03d){console[_0x2d5a13(0x195)](_0x2d5a13(0x1aa),_0x22d03d);}};function _0x722d(){const _0x428288=['\x20Relay\x20server\x20disconnected\x20(ID:\x20','localPort','sendMessage','split','disabled','alive','[MC\x20Relay]','Connection\x20started\x0aProximity\x20voice\x20chat:','<近接VC>言語を日本語に設定しました','partner_connected','name','close','For\x20a\x20persistent\x20connection,\x20run\x20the\x20following\x20command:','net','4492437uxqeQs','status','end','接続終了:\x20','http','Minecraftから以下のコマンドで接続してください:','pipe','Using\x20Proximity\x20Voice\x20Chat\x0aURL:https://proximity-vc-mcbe.pages.dev/\x0aRoomID\x20is\x20','★★★\x20[MC\x20Relay]\x20パートナー接続通知を受信。ローカルブリッジを構築します。\x20★★★','floor','近接vcを無効にしました','indexOf','yRots','sender','/connect\x20','values','remotePort','Open','true','Password\x20disabled','Participants\x20should\x20access\x20this\x20URL','スペクテイターが他モードプレイヤーの会話を聞けなくなりました','PlayerLeave','assign','value','\x20WebSocket\x20error:','runCommand','command_result','toRomaji','211753koEpcz','get-port','Password\x20is\x20','です\x0aあなたのVCnameは','Spectator\x20cannot\x20listen\x20to\x20other\x20gamemode\x20players','ssh2','readyState','run_command','SIGINT','readFileSync','Password\x20enabled','world_update','enabled','ホスト専用コマンド：\x0a\x20\u00a0!lang\x20-\x20!lang\x20<ja/en>\x20chenge\x20language\x0a\x20\u00a0!dis\x20-\x20!dis\x20<数値>\x20で声の届く距離を変更できます\x0a\x20\u00a0!pvc\x20-\x20!pvc\x20<true/false>\x20で近接vcを有効/無効にできます\x0a\x20\u00a0!spectator\x20-\x20!spectator\x20<true/false>\x20でスペクテイターとVCを分けます\x0a\x20\u00a0!specListen\x20-\x20!specListen\x20<true/false>\x20でスペクテイターが他モードプレイヤーの会話を聞けるようになります\x20\x0a\x20\u00a0!specDim\x20-\x20!specDim\x20<true/false>\x20でスペクテイター同士の会話をディメンションごとに分けます\x0a\x20\u00a0!password\x20-\x20!password\x20<true/false>\x20でパスワードを有効/無効にできます','querytarget\x20@e[type=player]','ROOM\x20ID:\x20','❌\x20ポートフォワーディング失敗\x20(','exit','\x20処理中にエラーが発生しました:','[VC\x20Relay]\x20メッセージ処理エラー:','553588TswyLJ','5263758ItWewy','victim','パスワードを無効にしました','false','\x1b[36m[Info]\x1b[0m\x20','tcp\x20connection','wss://','近接VCを使用中です\x0aURL:https://proximity-vc-mcbe.pages.dev/\x0aルームIDは','log','open','\x0a!help\x20でコマンド一覧を確認できます','toString','details','スペクテイター同士の会話を共通にしました','app.py','message','[MC\x20Local\x20WS\x20Error]','use','.tcpexposer.com','--------------------','data_update','Spectator`s\x20VC\x20separated\x20by\x20dimension','Changed\x20max\x20distance\x20to\x20','ws://127.0.0.1:','spectator','error','WorldRemove','常時接続する場合は以下のコマンドを実行してください:','URL:https://proximity-vc-mcbe.pages.dev/\x0aRoomID\x20is\x20','PlayerLoad','specDim','clients','./config.json','node-fetch','スペクテイターを共通のVCにしました','/room/','socket-be','remoteAddr','.tcpexposer.com\x22','Proximity\x20VC\x20enabled','に変更しました','4KlCWbU','Asia/Tokyo','distance','writeFileSync','Host-only\x20command：\x0a\x20\u00a0!lang\x20-\x20!lang\x20<ja/en>\x20言語を変更できます\x0a\x20\u00a0!dis\x20-\x20!dis\x20<Number>\x20set\x20max\x20distance\x0a\x20\u00a0!pvc\x20-\x20!pvc\x20<true/false>\x20enable/disable\x20proximity\x20voice\x20chat\x0a\x20\u00a0!spectator\x20-\x20!spectator\x20<true/false>\x20separate\x20spectator\x20and\x20VC\x0a\x20\u00a0!specListen\x20-\x20!specListen\x20<true/false>\x20Spectator\x20can\x20listen\x20to\x20other\x20gamemode\x20players\x0a\x20\u00a0!specDim\x20-\x20!specDim\x20<true/false>\x20Spectator`s\x20VC\x20separated\x20by\x20dimension\x0a\x20\u00a0!password\x20-\x20!password\x20<true/false>\x20enable/disable\x20password','❌\x20設定ファイルの更新に失敗しました:','typescript','5272560ggtIMY','112VbXRgx','スペクテイターとVCを分けました','correlationId','Command\x20list:\x0a\x20\u00a0!help\x20-\x20show\x20help\x0a\x20\u00a0!name\x20-\x20check\x20your\x20VC\x20GamerTag','tcpexposer.com','random','退出:\x20','声の最大距離を','type','proximity','[MC\x20SSH]','includes','disconnect_command','players','initialization','from','json','スペクテイターが他モードプレイヤーの会話を聞けるようになました','11NPUont','<Proximity\x20VC>Language\x20set\x20to\x20English','send','testfor\x20@e[type=player]','testfor\x20@a[m=spectator]','Server','path','name_command','\x0a!help\x20for\x20command\x20list','OPEN','Error\x20handling\x20world:','\x0a=======================================================','14562710DXkTJz','\x22\x5cs*:\x5cs*)(?:\x22.*?\x22|\x5cd+\x5c.?\x5cd*|true|false)','body','specListen','パスワードは','password','WebSocketメッセージの解析に失敗:','listen','\x20スペクテイター同士の会話をディメンションごとに分けました','https://proximity-vc-mcbe.pages.dev?roomid=','\x0a声の届く距離：','dimensions','WebSocket\x20error:','localPlayer','connect','3124140xmENTb','/pvc:connect\x20\x22','Connect\x20from\x20Minecraft\x20with\x20the\x20following\x20command:','position','\x0aMax\x20distance:','参加者はこのURLにアクセスしてください:','post','spectators','コマンド一覧：\x0a\x20\u00a0!help\x20-\x20ヘルプを表示します\x0a\x20\u00a0!name\x20-\x20VCで使うゲーマータグを確認できます','stringify','createConnection','utf8','❌\x20SSH\x20Error\x20(','14JyLERR','roomId','forEach','all','\x0aYour\x20VCname\x20is\x20','終了シグナル受信。SSH接続を停止します...','parse','json5','lang','action','WorldAdd','wanakana','中継サーバーを使用します\x20(Relay\x20server\x20will\x20be\x20used)','string','dimension','https://','Spectator`s\x20VC\x20set\x20to\x20common\x20in\x20all\x20dimensions','=======================================================\x0a','ready'];_0x722d=function(){return _0x428288;};return _0x722d();}async function main(){const _0x3d85bd=_0x13807c;port=await getPort({'port':port}),web_port=await getPort({'port':web_port}),server_log_info('socket-beサーバーのポート:\x20'+port);let _0x460036;if(!streamlit){const _0x1d2b1b=express(),_0x4dcf74=http['createServer'](_0x1d2b1b);_0x4dcf74[_0x3d85bd(0x1d2)](port),_0x460036=new Server({'webSocketOptions':{'server':_0x4dcf74},'timezone':_0x3d85bd(0x1a6),'disableEncryption':!![]}),_0x1d2b1b[_0x3d85bd(0x18d)](express['json']()),_0x1d2b1b[_0x3d85bd(0x1e0)]('/',(_0x3f9151,_0x276f0a)=>{const _0xdfe69=_0x3d85bd;if(_0x3f9151[_0xdfe69(0x1cd)][_0xdfe69(0x1b5)]===_0xdfe69(0x1c6)){const _0x38442d=name_command(_0x3f9151[_0xdfe69(0x1cd)][_0xdfe69(0x215)]),_0x54936a={'type':_0xdfe69(0x1c6),'message':_0x38442d};_0x276f0a[_0xdfe69(0x209)](0xc8)[_0xdfe69(0x1bd)](_0x54936a);}else{if(_0x3f9151[_0xdfe69(0x1cd)]['type']==='initialization'){mc_connected=!![];const _0x3fec0d={'type':_0xdfe69(0x1bb),'roomId':roomId,'proximity':proximity,'distance':distance,'spectator':spectator,'specListen':specListen,'specDim':specDim,'password':password,'lang':lang};_0x276f0a[_0xdfe69(0x209)](0xc8)['json'](_0x3fec0d);}else{if(_0x3f9151[_0xdfe69(0x1cd)][_0xdfe69(0x1b5)]===_0xdfe69(0x190))data_update(_0x3f9151[_0xdfe69(0x1cd)]),_0x276f0a[_0xdfe69(0x209)](0xc8)['json']({'success':!![]});else _0x3f9151['body'][_0xdfe69(0x1b5)]===_0xdfe69(0x1b9)&&process[_0xdfe69(0x236)](0x0);}}});}else _0x460036=new Server({'port':port,'timezone':_0x3d85bd(0x1a6),'disableEncryption':!![]});const _0x3a4667=(_0x3780a1,_0x548159,_0x95e862)=>async(_0x4cc7fe,_0x5bf531,_0x5a9567)=>{const _0x12b008=_0x3d85bd;if(_0x5bf531['name']!==_0x4cc7fe[_0x12b008(0x1d8)][_0x12b008(0x204)])return;if(_0x5a9567[0x0]!==_0x12b008(0x21a)&&_0x5a9567[0x0]!==_0x12b008(0x23d))return;const _0x2deb35=_0x5a9567[0x0]===_0x12b008(0x21a);if(_0x3780a1===_0x12b008(0x1d0))password=_0x2deb35;else{if(_0x3780a1===_0x12b008(0x1b6))proximity=_0x2deb35;else{if(_0x3780a1===_0x12b008(0x194))spectator=_0x2deb35;else{if(_0x3780a1==='specListen')specListen=_0x2deb35;else{if(_0x3780a1==='specDim')specDim=_0x2deb35;}}}}updateConfig(_0x3780a1,_0x2deb35),Object[_0x12b008(0x21f)](global,{[_0x3780a1]:_0x2deb35});const _0x3b7939=lang==='ja'?_0x2deb35?_0x548159[_0x12b008(0x231)]:_0x548159['disabled']:_0x2deb35?_0x95e862['enabled']:_0x95e862['disabled'];await _0x4cc7fe[_0x12b008(0x1fc)](_0x3b7939);},_0x4968bd={'!dis':async(_0x10d930,_0x5c198f,_0x71f0f2)=>{const _0x5d8bcd=_0x3d85bd;try{if(_0x5c198f['name']!==_0x10d930[_0x5d8bcd(0x1d8)][_0x5d8bcd(0x204)])return;const _0x51350a=Number(_0x71f0f2[0x0]);if(!isNaN(_0x51350a)){distance=_0x51350a,updateConfig(_0x5d8bcd(0x1a7),_0x51350a);const _0x5a2ed3=lang==='ja'?_0x5d8bcd(0x1b4)+distance+_0x5d8bcd(0x1a4):_0x5d8bcd(0x192)+distance;await _0x10d930[_0x5d8bcd(0x1fc)](_0x5a2ed3);}}catch(_0x1347ed){}},'!name':async(_0x5c72e4,_0x4a6d7d)=>{const _0x372510=_0x3d85bd;try{const _0x3063ec=processName(_0x4a6d7d['name']),_0x96928a='URL:https://proximity-vc-mcbe.pages.dev/\x0aルームIDは'+roomId+_0x372510(0x228)+_0x3063ec+'です',_0x1c6752=_0x372510(0x198)+roomId+_0x372510(0x1eb)+_0x3063ec;await _0x4a6d7d[_0x372510(0x1fc)](lang==='ja'?_0x96928a:_0x1c6752);if(password){!passwords[_0x3063ec]&&(passwords[_0x3063ec]=Math['floor'](0x3e8+Math[_0x372510(0x1b2)]()*0x2328)[_0x372510(0x187)]());const _0x16caf6=lang==='ja'?_0x372510(0x1cf)+passwords[_0x3063ec]+'です':_0x372510(0x227)+passwords[_0x3063ec];await _0x4a6d7d[_0x372510(0x1fc)](_0x16caf6);}}catch(_0x5786df){}},'!password':_0x3a4667(_0x3d85bd(0x1d0),{'enabled':'パスワードを有効にしました','disabled':_0x3d85bd(0x23c)},{'enabled':_0x3d85bd(0x22f),'disabled':_0x3d85bd(0x21b)}),'!pvc':_0x3a4667(_0x3d85bd(0x1b6),{'enabled':'近接vcを有効にしました','disabled':_0x3d85bd(0x212)},{'enabled':_0x3d85bd(0x1a3),'disabled':'Proximity\x20VC\x20disabled'}),'!spectator':_0x3a4667(_0x3d85bd(0x194),{'enabled':_0x3d85bd(0x1ae),'disabled':_0x3d85bd(0x19e)},{'enabled':'Spectator\x20and\x20VC\x20separated','disabled':'Spectator\x20set\x20to\x20common\x20VC'}),'!specListen':_0x3a4667(_0x3d85bd(0x1ce),{'enable':_0x3d85bd(0x1be),'disable':_0x3d85bd(0x21d)},{'enable':'Spectator\x20can\x20listen\x20to\x20other\x20gamemode\x20players','disable':_0x3d85bd(0x229)}),'!specDim':_0x3a4667(_0x3d85bd(0x19a),{'enable':_0x3d85bd(0x1d3),'disable':_0x3d85bd(0x189)},{'enable':_0x3d85bd(0x191),'disable':_0x3d85bd(0x1f7)}),'!lang':async(_0xe9ac7f,_0x545423,_0x44cda6)=>{const _0x40c375=_0x3d85bd;try{if(_0x545423['name']!==_0xe9ac7f[_0x40c375(0x1d8)][_0x40c375(0x204)])return;const _0x338766=_0x44cda6[0x0]==='ja'?'ja':'en';lang=_0x338766,updateConfig(_0x40c375(0x1ef),_0x338766);const _0x41a6ec=_0x338766==='ja'?_0x40c375(0x202):_0x40c375(0x1c0);await _0xe9ac7f[_0x40c375(0x1fc)](_0x41a6ec);}catch(_0x2d4eaa){}},'!help':async(_0xe89ec6,_0x532f66)=>{const _0x4479d6=_0x3d85bd;try{await _0x532f66[_0x4479d6(0x1fc)]('--------------------');if(lang=='ja'){await _0x532f66[_0x4479d6(0x1fc)](_0x4479d6(0x1e2));const _0x25a758=_0xe89ec6[_0x4479d6(0x1d8)][_0x4479d6(0x204)];_0x532f66[_0x4479d6(0x204)]==_0x25a758&&await _0x532f66[_0x4479d6(0x1fc)](_0x4479d6(0x232));}else{await _0x532f66[_0x4479d6(0x1fc)](_0x4479d6(0x1b0));const _0x184c4e=_0xe89ec6[_0x4479d6(0x1d8)][_0x4479d6(0x204)];_0x532f66[_0x4479d6(0x204)]==_0x184c4e&&await _0x532f66[_0x4479d6(0x1fc)](_0x4479d6(0x1a9));}await _0x532f66[_0x4479d6(0x1fc)](_0x4479d6(0x18f));}catch(_0xccc689){}}};_0x460036['on'](ServerEvent['PlayerChat'],async({sender:_0x3ba339,message:_0x189c53,world:_0x857b7d})=>{const _0x1c147c=_0x3d85bd,[_0x2ebc89,..._0x27362a]=_0x189c53[_0x1c147c(0x1fd)]('\x20');if(_0x4968bd[_0x2ebc89])await _0x4968bd[_0x2ebc89](_0x857b7d,_0x3ba339,_0x27362a);}),_0x460036['on'](ServerEvent[_0x3d85bd(0x219)],()=>setupWebSocketServer()),_0x460036['on'](ServerEvent[_0x3d85bd(0x1f1)],async({world:_0x4d1ea2})=>{const _0x490676=_0x3d85bd;shouldBroadcast=![],mc_connected=!![],mainWorld=_0x4d1ea2,stop_roop=![],server_log_info('接続開始:\x20'+_0x4d1ea2[_0x490676(0x204)]);if(lang=='ja'){let _0xcac6f8='';proximity?_0xcac6f8='有効':_0xcac6f8='無効',_0x4d1ea2[_0x490676(0x1fc)]('接続を開始しました\x0a近接vc：'+_0xcac6f8+_0x490676(0x1d5)+distance+_0x490676(0x186));}else{let _0x6c08db='';proximity?_0x6c08db=_0x490676(0x231):_0x6c08db=_0x490676(0x1fe),_0x4d1ea2[_0x490676(0x1fc)](_0x490676(0x201)+_0x6c08db+_0x490676(0x1de)+distance+_0x490676(0x1c7));}await handleWorld(_0x4d1ea2);}),_0x460036['on'](ServerEvent[_0x3d85bd(0x196)],({world:_0xc3f794})=>{const _0x4aaa5c=_0x3d85bd;mainWorld=null,stop_roop=!![],server_log_info(_0x4aaa5c(0x20b)+_0xc3f794['name']);}),_0x460036['on'](ServerEvent[_0x3d85bd(0x199)],async({player:_0x3f2040,world:_0x543e86})=>{server_log_info('参加:\x20'+_0x3f2040['name']);const _0x5e69df=setInterval(async()=>{const _0x68065d=_0x157d;try{const _0x4f80db=processName(_0x3f2040['name']),_0x1ad7dd=_0x68065d(0x183)+roomId+_0x68065d(0x228)+_0x4f80db+'です',_0x4a9562=_0x68065d(0x20f)+roomId+'\x0aYour\x20VCname\x20is\x20'+_0x4f80db;await _0x3f2040[_0x68065d(0x1fc)](lang==='ja'?_0x1ad7dd:_0x4a9562);if(password){!passwords[_0x4f80db]&&(passwords[_0x4f80db]=Math[_0x68065d(0x211)](0x3e8+Math[_0x68065d(0x1b2)]()*0x2328)[_0x68065d(0x187)]());const _0x12013d=lang==='ja'?_0x68065d(0x1cf)+passwords[_0x4f80db]+'です':_0x68065d(0x227)+passwords[_0x4f80db];await _0x3f2040[_0x68065d(0x1fc)](_0x12013d);}clearInterval(_0x5e69df);}catch(_0x3055f6){}},0x1f4);}),_0x460036['on'](ServerEvent[_0x3d85bd(0x21e)],({player:_0x6c91a4,world:_0x473373})=>{const _0x228c1a=_0x3d85bd;server_log_info(_0x228c1a(0x1b3)+_0x6c91a4[_0x228c1a(0x204)]);const _0x28cd99=_0x473373['localPlayer'][_0x228c1a(0x204)];if(_0x6c91a4['name']===_0x28cd99)process[_0x228c1a(0x236)](0x0);delete positions[processName(_0x6c91a4[_0x228c1a(0x204)])];}),setInterval(()=>{if(shouldBroadcast&&vc_connected){broadcastPositions();if(mc_connected)shouldBroadcast=![];}},0x32),(sub_domain===''||username===''||ssh_password==='')&&(server_log_info(_0x3d85bd(0x1f3)),await connectToRelayServer('mc'),await connectToRelayServer('vc'));}main();
